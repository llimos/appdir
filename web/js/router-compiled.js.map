{"version":3,"sources":["router.jsx"],"names":[],"mappings":"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","file":"router-compiled.js","sourcesContent":["$(function(){\r\n    (function router(page, document, headerContainer, contentContainer, navContainer, modalContainer, alertsContainer, appData, ReactDOM, $){\r\n\r\n        var renderApp = function renderApp (title, header, content, activeMenu){\r\n            // Title\r\n            document.title = (title ? title + \" :: \" : \"\") + \"Application Directory\";\r\n            // Header\r\n            ReactDOM.render(header, headerContainer);\r\n            // Content\r\n            ReactDOM.render(content, contentContainer);\r\n            // Active menu item\r\n            ReactDOM.render(<NavBar active={activeMenu}/>, navContainer);\r\n        };\r\n\r\n        // Routing\r\n        var currentPage;\r\n\r\n        // Transition on all pages\r\n        page('*', function(ctx, next){\r\n            // If only the hash changed, don't apply transition\r\n            if (ctx.init || ctx.path.split('#')[0] == currentPage) {\r\n                next();\r\n            } else {\r\n                contentContainer.classList.add('transition');\r\n                headerContainer.classList.add('transition');\r\n                setTimeout(function(){\r\n                    contentContainer.classList.remove('transition');\r\n                    headerContainer.classList.remove('transition');\r\n                    next();\r\n                }, 150);\r\n            }\r\n        });\r\n\r\n        // Homepage\r\n        page('/', function(ctx, next){\r\n            renderApp(null, <PageHeader title=\"Application Directory\"/>, <Homepage/>, null);\r\n            ctx.handled = true;\r\n            next();\r\n        });\r\n\r\n        // App list\r\n        page('/app/', function(ctx, next){\r\n            // Convert app list to array\r\n            var apps = [];\r\n            for (var id in appData.app) {\r\n                apps.push(appData.app[id]);\r\n            }\r\n\r\n            var add = function() {\r\n                var modal; // The 'ref' will populate this\r\n\r\n                var save = function(data) {\r\n                    console.log(data);\r\n                    data = {\"app\": data};\r\n                    jQuery.post('/app_dev.php/api/app', data)\r\n                        .done(function(response){\r\n                            // Close and unmount\r\n                            modal.close(function(){ReactDOM.unmountComponentAtNode(modalContainer);});\r\n\r\n                            // Display message\r\n                            ReactDOM.render(<Alert type=\"success\">App created: {response.name}</Alert>, alertsContainer);\r\n                        })\r\n                        .done(function(response){\r\n                            var id = response.id;\r\n                            window.app.data.app[id] = response;\r\n                        })\r\n                        .fail(function(jqxhr){\r\n                            var response = jqxhr.responseJSON;\r\n                            // Display error message\r\n                            console.log('Problem');\r\n                            console.log(response);\r\n                            modal.setState({message: response.message});\r\n                        });\r\n\r\n                    // If failure\r\n                    // Don't close\r\n                    // Put error message in the form\r\n                }\r\n\r\n\r\n\r\n                // Open the modal for adding an app\r\n                ReactDOM.render(<ModalDialog title=\"New app\" onSave={save} ref={(c)=>modal=c}><AppForm app={{}}/></ModalDialog>, modalContainer);\r\n            };\r\n\r\n            renderApp('Apps', <PageHeader title=\"Apps\" button={add} buttonText=\"+ Add\"/>, <AppList apps={apps}/>, 'Apps');\r\n            ctx.handled = true;\r\n            next();\r\n        });\r\n\r\n        // App info\r\n        page('/app/:appId', function(ctx, next){\r\n            var app = appData.app[ctx.params.appId];\r\n            var hash = window.location.hash.substring(1);\r\n            var activeTab;\r\n            if (hash && hash.substr(0, 11) === 'deployment-') {\r\n                activeTab = 'deployments';\r\n            }\r\n            else if (hash && hash.substr(0, 11) === 'connection-') {\r\n                activeTab = 'connections';\r\n            }\r\n            else {\r\n                activeTab = hash;\r\n            }\r\n            renderApp(\r\n                app.name,\r\n                <PageHeader title={app.name} label={app.type} button={function(){}} subtitle={app.info}/>,\r\n                <AppInfo app={app} activeTab={activeTab}/>,\r\n                'Apps'\r\n            );\r\n            ctx.handled = true;;\r\n            next();\r\n        });\r\n\r\n        // Server list\r\n        page('/server/', function(ctx, next){\r\n            // Convert servers list to array\r\n            var servers = [];\r\n            for (var id in appData.server) {\r\n                servers.push(appData.server[id]);\r\n            }\r\n            renderApp('Servers', <PageHeader title=\"Servers\" button={function(){}} buttonText=\"+ Add\"/>, <ServerList servers={servers}/>, 'Servers');\r\n            ctx.handled = true;\r\n            next();\r\n        });\r\n\r\n        // Server info\r\n        page('/server/:serverId', function(ctx, next){\r\n            var server = appData.server[ctx.params.serverId];\r\n            renderApp(\r\n                server.name,\r\n                <PageHeader title={server.name} button={function(){}} subtitle={server.ip}/>,\r\n                <ServerInfo server={server}/>,\r\n                'Servers'\r\n            );\r\n            ctx.handled = true;\r\n            next();\r\n        });\r\n\r\n        // After rendering, de-linkify all links that are to the current page\r\n        page('*', function(ctx, next) {\r\n            $('a.unlink').removeClass('unlink');\r\n            $('a[href=\"' + ctx.canonicalPath + '\"], a[href=\"' + ctx.canonicalPath.split('#')[0] + '\"]').addClass('unlink');\r\n            next();\r\n        });\r\n\r\n        page('*', function(ctx, next) {\r\n            currentPage = ctx.path.split('#')[0];\r\n        });\r\n\r\n        // Go forth young router\r\n        page();\r\n    })(page, document, document.getElementById('page-header'), document.getElementById('page-content'), document.getElementById('nav-bar'), document.getElementById('modal-container'), document.getElementById('alerts-container'), app.data, ReactDOM, jQuery);\r\n});"]}